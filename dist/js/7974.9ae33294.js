"use strict";(self["webpackChunk_coreui_coreui_pro_vue_admin_template"]=self["webpackChunk_coreui_coreui_pro_vue_admin_template"]||[]).push([[7974],{7974:function(t,e,o){o.r(e),o.d(e,{default:function(){return g}});var l=o(3396),a=o(2268);const s={class:"box"},n={class:"table-responsive table-borderless"},c={class:"text-center"},i={class:"text-center"};function r(t,e,o,r,u,d){const m=(0,l.up)("CIcon"),_=(0,l.up)("CCal"),k=(0,l.up)("CRow"),p=(0,l.up)("CCardHeader"),g=(0,l.up)("CBadge"),w=(0,l.up)("CButton"),C=(0,l.up)("CCardBody"),h=(0,l.up)("CCollapse"),T=(0,l.up)("CSmartTable"),y=(0,l.up)("CCard");return(0,l.wg)(),(0,l.iD)("div",s,[(0,l.Wm)(y,{class:"p-2"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[(0,l.Wm)(k,null,{default:(0,l.w5)((()=>[(0,l.Wm)(_,null,{default:(0,l.w5)((()=>[(0,l._)("h2",null,[(0,l.Wm)(m,{icon:"cilBookmark",id:"book",size:"xxl",color:"drak"}),(0,l.Uk)(" Bookmark")])])),_:1})])),_:1})])),_:1}),(0,l._)("div",n,[(0,l.Wm)(T,{"active-page":1,header:"",cleaner:"",items:r.items,columns:r.columns,columnFilter:"","column-sorter":"","clickable-rows":"","table-filter":"","items-per-page":5,"items-per-page-select":"",pagination:"",columnSorter:"",sorterValue:{column:"status",state:"asc"},"table-props":{striped:!0,hover:!0}},{STATUS:(0,l.w5)((({item:t})=>[(0,l._)("td",null,[(0,l.Wm)(g,{color:r.getBadge(t.STATUS)},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(t.STATUS),1)])),_:2},1032,["color"])])])),BOOKMARK:(0,l.w5)((({item:t,index:e})=>[(0,l._)("td",c,[(0,l.Wm)(w,{variant:"outline",square:"",size:"xl",onClick:o=>r.toggleDetails(t,e)},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(Boolean(t.BOOKMARK)?"👁️":"🙈"),1)])),_:2},1032,["onClick"])])])),MORE:(0,l.w5)((({item:t,index:e})=>[(0,l._)("td",i,[(0,l.Wm)(w,{color:"primary",variant:"outline",square:"",size:"xl",onClick:o=>d.toggleButton(t,e)},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(Boolean(t.MORE)?"Hide":"Show"),1)])),_:2},1032,["onClick"])])])),details:(0,l.w5)((({item:t,index:e})=>[(0,l.Wm)(h,{visible:Boolean(t.MORE)},{default:(0,l.w5)((()=>[(0,l.Wm)(C,null,{default:(0,l.w5)((()=>[(0,l._)("h4",null,(0,a.zw)(t.tkt_title),1),(0,l.Wm)(w,{size:"sm",color:"info",class:"",onClick:o=>d.contactIt(t,e)},{default:(0,l.w5)((()=>[(0,l.Uk)(" ติดต่อ It Suport ")])),_:2},1032,["onClick"]),(0,l.Wm)(w,{size:"sm",color:"danger",class:"ml-3",onClick:o=>d.buttonCancel(t,e)},{default:(0,l.w5)((()=>[(0,l.Uk)(" Cancel ")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1032,["visible"])])),_:1},8,["items","columns"])])])),_:1})])}o(7658);var u=o(4870),d=o(5428),m=o(4161),_={name:"SmartTableBasixExample",setup(){const t=[{key:"#",_style:{width:"5%"}},{key:"TicketID",_style:{width:"10%"}},{key:"TITLE",_style:{width:"10%"}},{key:"START DATE",_style:{width:"11%"}},{key:"STATUS",_style:{width:"5%"}},{key:"TYPE",_style:{width:"4%"}},{key:"BOOKMARK",_style:{width:"5%"}},{key:"MORE",_style:{width:"5%"}}],e=(0,u.iH)([]),o=t=>{switch(t){case"Pending":return"success";case"Open":return"secondary";case"Closed":return"warning";case"Banned":return"danger";default:return"primary"}},l=async t=>{t.BOOKMARK=!t.BOOKMARK,console.log(t.BOOKMARK),console.log(t);try{const e=t._id.toString();await m.Z.put(`http://localhost:3000/mongoose/update/stts_tickets/${e}`,{data:{tkt_book:t.BOOKMARK}}),console.log("อัปเดต BOOKMARK และส่งข้อมูลไปยัง MongoDB สำเร็จ")}catch(e){console.error("เกิดข้อผิดพลาดในการอัปเดตข้อมูล:",e)}};return{columns:t,items:e,getBadge:o,toggleDetails:l}},components:{CRow:d.rbF,CCol:d.b7O},methods:{async contactIt(t){const e=t._id.toString();this.$router.push({name:"ST - comment Ticket",params:{itemId:e}}),console.log("Item ID:",e)},async buttonCancel(t){try{const e=t._id.toString();await m.Z.put(`http://localhost:3000/mongoose/update/stts_tickets/${e}`,{data:{tkt_status:"Cancel"}}),console.log("อัปเดต BOOKMARK และส่งข้อมูลไปยัง MongoDB สำเร็จ"),window.location.reload()}catch(e){console.error("เกิดข้อผิดพลาดในการอัปเดตข้อมูล:",e)}},async toggleButton(t){t.MORE=!t.MORE},async getTicket(){try{const t=JSON.parse(localStorage.getItem("USER_DATA")),e=t.id.toString(),o=await m.Z.post("http://localhost:3000/mongoose/get/stts_tickets",{where:{tkt_act:e,tkt_book:"true",tkt_status:{$ne:"Cancel"}}});console.log(o.data),console.log(e),this.items=o.data.map(((t,e)=>({"#":e+1,_id:t._id,TicketID:t.tkt_number,TITLE:t.tkt_title,"START DATE":t.tkt_time,STATUS:t.tkt_status,TYPE:t.tkt_types,BOOKMARK:t.tkt_book,_toggled:!1})))}catch(t){console.error("Error fetching data:",t)}}},mounted(){this.getTicket()}},k=o(89);const p=(0,k.Z)(_,[["render",r]]);var g=p}}]);
//# sourceMappingURL=7974.9ae33294.js.map